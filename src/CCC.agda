module CCC where

open import Basis
open import Cubical

module CCC where

๐ : โ {ฮ} โ Presheaf ฮ
๐ {ฮ} .apโ x = S.๐
๐ {ฮ} .apโ f = S.idn
๐ {ฮ} .apโ ฮฑ {()}
๐ {ฮ} .coh-idn {x} {()}
๐ {ฮ} .coh-cmp g f {()}

ยก : โ {ฮ} {๐ณ : Presheaf ฮ} โ Transform ๐ ๐ณ
ยก {๐ณ = ๐ณ} .apโ x = S.ยก
ยก {๐ณ = ๐ณ} .apโ f {()}

๐ : โ {ฮ} โ Presheaf ฮ
๐ {ฮ} .apโ x = S.๐
๐ {ฮ} .apโ f = S.idn
๐ {ฮ} .apโ ฮฑ = *
๐ {ฮ} .coh-idn = *
๐ {ฮ} .coh-cmp g f = *

! : โ {ฮ} {๐ณ : Presheaf ฮ} โ Transform ๐ณ ๐
! {๐ณ = ๐ณ} .apโ x = S.!
! {๐ณ = ๐ณ} .apโ f = *

_โ_ : โ {ฮ} (๐ณ ๐ด : Presheaf ฮ) โ Presheaf ฮ
(๐ณ โ ๐ด) .apโ x = apโ ๐ณ x S.โ apโ ๐ด x
(๐ณ โ ๐ด) .apโ f = S.โจ apโ ๐ณ f โ apโ ๐ด f โฉ
(๐ณ โ ๐ด) .apโ ฮฑ = apโ ๐ณ ฮฑ , apโ ๐ด ฮฑ
(๐ณ โ ๐ด) .coh-idn = coh-idn ๐ณ , coh-idn ๐ด
(๐ณ โ ๐ด) .coh-cmp g f = coh-cmp ๐ณ g f , coh-cmp ๐ด g f

fst : โ {ฮ} {๐ณ ๐ด : Presheaf ฮ} โ Transform (๐ณ โ ๐ด) ๐ณ
fst {ฮ}{๐ณ}{๐ด} .apโ x = S.fst
fst {ฮ}{๐ณ}{๐ด} .apโ f = idnโ (apโ ๐ณ _)

snd : โ {ฮ} {๐ณ ๐ด : Presheaf ฮ} โ Transform (๐ณ โ ๐ด) ๐ด
snd {ฮ}{๐ณ}{๐ด} .apโ x = S.snd
snd {ฮ}{๐ณ}{๐ด} .apโ f = idnโ (apโ ๐ด _)

โจ_,_โฉ
  : โ {ฮ} {๐ณ ๐ด H : Presheaf ฮ}
  โ (ฮฑ : Transform H ๐ณ)
  โ (ฮฒ : Transform H ๐ด)
  โ Transform H (๐ณ โ ๐ด)
โจ ฮฑ , ฮฒ โฉ .apโ x = S.โจ apโ ฮฑ x , apโ ฮฒ x โฉ
โจ ฮฑ , ฮฒ โฉ .apโ f = apโ ฮฑ f , apโ ฮฒ f

_โโ_
  : โ {ฮ} (๐ณ ๐ด : Presheaf ฮ)
  โ โช ฮ โซ .โ
  โ Setoid
_โโ_ {ฮ} ๐ณ ๐ด x = โชhomโซ (C.โชFunctorโซ (C.Op ฮ) C.โชSetoidโซ) (apโ (Yoneda ฮ) x โ ๐ณ) ๐ด

_โโโ_
  : โ {ฮ} (๐ณ ๐ด : Presheaf ฮ) {y a}
  โ ฮ โง a โพ y
  โ C.โชFunctorโซ _ _ โง apโ (Yoneda ฮ) y โ ๐ณ โพ ๐ด
  โ C.โชFunctorโซ _ _ โง apโ (Yoneda ฮ) a โ ๐ณ โพ ๐ด
_โโโ_ {ฮ} ๐ณ ๐ด {y}{a} g ฮฑ .apโ x .apโ (f , s) = apโ (apโ ฮฑ x) (cmpโ ฮ g f , s)
_โโโ_ {ฮ} ๐ณ ๐ด {y}{a} g ฮฑ .apโ x .apโ {fโ , sโ}{fโ , sโ} (ฮฒ , p) = apโ (apโ ฮฑ x) (coh-ฯ-ฯ ฮ ฮฒ , p)
_โโโ_ {ฮ} ๐ณ ๐ด {y}{b} g ฮฑ .apโ {a}{x} k {f , s} =
  cmpโ (apโ ๐ด x)
    (apโ ฮฑ k)
    (apโ (apโ ฮฑ x) (invโ ฮ (coh-ฮฑ ฮ) , idnโ (apโ ๐ณ x)))

_โโโ_
  : โ {ฮ} (๐ณ ๐ด : Presheaf ฮ) {y a} (g : โช ฮ โซ .โ a y .โ) {ฮฑ ฮฒ}
  โ hom ((๐ณ โโ ๐ด) y) ฮฑ ฮฒ
  โ hom ((๐ณ โโ ๐ด) a) ((๐ณ โโโ ๐ด) g ฮฑ) ((๐ณ โโโ ๐ด) g ฮฒ)
_โโโ_ {ฮ} ๐ณ ๐ด {y}{a} g {ฮฑ}{ฮฒ} p {x} {f , s} = p

_โโ_
  : โ {ฮ} (๐ณ ๐ด : Presheaf ฮ) {x y}
  โ ฮ โง y โพ x
  โ C.โชSetoidโซ โง (๐ณ โโ ๐ด) x โพ (๐ณ โโ ๐ด) y
_โโ_ ๐ณ ๐ด f .apโ = (๐ณ โโโ ๐ด) f
_โโ_ ๐ณ ๐ด f .apโ {ฮฑ}{ฮฒ} = (๐ณ โโโ ๐ด) f {ฮฑ}{ฮฒ}

_โโ_
  : โ {ฮ} (๐ณ ๐ด : Presheaf ฮ)
  โ โ {y a}{gโ gโ : C.Op ฮ โง y โพ a}
  โ C.Op ฮ โง gโ โ gโ
  โ C.โชSetoidโซ โง (๐ณ โโ ๐ด) gโ โ (๐ณ โโ ๐ด) gโ
_โโ_ {ฮ} ๐ณ ๐ด {y}{a}{gโ}{gโ} p {ฮฑ}{x}{f , s} = apโ (apโ ฮฑ x) (coh-ฯ-ฮป ฮ p , idnโ (apโ ๐ณ x))

_โ_ : โ {ฮ} (๐ณ ๐ด : Presheaf ฮ) โ Presheaf ฮ
_โ_ {ฮ} ๐ณ ๐ด .apโ = ๐ณ โโ ๐ด
_โ_ {ฮ} ๐ณ ๐ด .apโ = ๐ณ โโ ๐ด
_โ_ {ฮ} ๐ณ ๐ด .apโ = ๐ณ โโ ๐ด
_โ_ {ฮ} ๐ณ ๐ด .coh-idn {y}{ฮฑ}{x}{f , s} = apโ (apโ ฮฑ x) (coh-ฮป ฮ , idnโ (apโ ๐ณ x))
_โ_ {ฮ} ๐ณ ๐ด .coh-cmp {y}{b}{a} g h {ฮฑ}{x}{f , s} = apโ (apโ ฮฑ x) (coh-ฮฑ ฮ , idnโ (apโ ๐ณ x))
