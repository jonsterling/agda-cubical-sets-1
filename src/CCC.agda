module CCC where

open import Basis
open import Cubical

module CCC where

open C
  using (Op)
  using (â‰ªFunctorâ‰«)
  using (â‰ªSetoidâ‰«)
  using (â‰ª_[-,_]â‰«)
  using (â‰ª_âˆ˜-â‰«â‚)

ğŸ˜ : âˆ€ {Î“} â†’ Presheaf Î“
ğŸ˜ {Î“} .apâ‚€ x = S.ğŸ˜
ğŸ˜ {Î“} .apâ‚ f = S.idn
ğŸ˜ {Î“} .apâ‚‚ Î± {()}
ğŸ˜ {Î“} .coh-idn {x} {()}
ğŸ˜ {Î“} .coh-cmp g f {()}

Â¡ : âˆ€ {Î“} {ğ’³ : Presheaf Î“} â†’ Transform ğŸ˜ ğ’³
Â¡ {ğ’³ = ğ’³} .apâ‚€ x = S.Â¡
Â¡ {ğ’³ = ğ’³} .apâ‚ f {()}

ğŸ™ : âˆ€ {Î“} â†’ Presheaf Î“
ğŸ™ {Î“} .apâ‚€ x = S.ğŸ™
ğŸ™ {Î“} .apâ‚ f = S.idn
ğŸ™ {Î“} .apâ‚‚ Î± = *
ğŸ™ {Î“} .coh-idn = *
ğŸ™ {Î“} .coh-cmp g f = *

! : âˆ€ {Î“} {ğ’³ : Presheaf Î“} â†’ Transform ğ’³ ğŸ™
! {ğ’³ = ğ’³} .apâ‚€ x = S.!
! {ğ’³ = ğ’³} .apâ‚ f = *

_âŠ—_ : âˆ€ {Î“} (ğ’³ ğ’´ : Presheaf Î“) â†’ Presheaf Î“
(ğ’³ âŠ— ğ’´) .apâ‚€ x = apâ‚€ ğ’³ x S.âŠ— apâ‚€ ğ’´ x
(ğ’³ âŠ— ğ’´) .apâ‚ f = S.âŸ¨ apâ‚ ğ’³ f âŠ— apâ‚ ğ’´ f âŸ©
(ğ’³ âŠ— ğ’´) .apâ‚‚ Î± = apâ‚‚ ğ’³ Î± , apâ‚‚ ğ’´ Î±
(ğ’³ âŠ— ğ’´) .coh-idn = coh-idn ğ’³ , coh-idn ğ’´
(ğ’³ âŠ— ğ’´) .coh-cmp g f = coh-cmp ğ’³ g f , coh-cmp ğ’´ g f

fst : âˆ€ {Î“} {ğ’³ ğ’´ : Presheaf Î“} â†’ Transform (ğ’³ âŠ— ğ’´) ğ’³
fst {Î“}{ğ’³}{ğ’´} .apâ‚€ x = S.fst
fst {Î“}{ğ’³}{ğ’´} .apâ‚ f = idnâ‚€ (apâ‚€ ğ’³ _)

snd : âˆ€ {Î“} {ğ’³ ğ’´ : Presheaf Î“} â†’ Transform (ğ’³ âŠ— ğ’´) ğ’´
snd {Î“}{ğ’³}{ğ’´} .apâ‚€ x = S.snd
snd {Î“}{ğ’³}{ğ’´} .apâ‚ f = idnâ‚€ (apâ‚€ ğ’´ _)

âŸ¨_,_âŸ©
  : âˆ€ {Î“} {ğ’³ ğ’´ H : Presheaf Î“}
  â†’ (Î± : Transform H ğ’³)
  â†’ (Î² : Transform H ğ’´)
  â†’ Transform H (ğ’³ âŠ— ğ’´)
âŸ¨ Î± , Î² âŸ© .apâ‚€ x = S.âŸ¨ apâ‚€ Î± x , apâ‚€ Î² x âŸ©
âŸ¨ Î± , Î² âŸ© .apâ‚ f = apâ‚ Î± f , apâ‚ Î² f

_â‡’â‚€_
  : âˆ€ {Î“} (ğ’³ ğ’´ : Presheaf Î“)
  â†’ âŸª Î“ âŸ« .â—
  â†’ Setoid
_â‡’â‚€_ {Î“} ğ’³ ğ’´ x = â‰ªhomâ‰« (â‰ªFunctorâ‰« (Op Î“) â‰ªSetoidâ‰«) (â‰ª Î“ [-, x ]â‰« âŠ— ğ’³) ğ’´

_â‡’â‚â‚€â‚€_
  : âˆ€ {Î“} (ğ’³ ğ’´ : Presheaf Î“) {y a x}
  â†’ Î“ âŠ§ a â‡¾ y
  â†’ â‰ªFunctorâ‰« _ _ âŠ§ â‰ª Î“ [-, y ]â‰« âŠ— ğ’³ â‡¾ ğ’´
  â†’ â‰ªSetoidâ‰« âŠ§ â‰ªhomâ‰« Î“ x a S.âŠ— apâ‚€ ğ’³ x â‡¾ apâ‚€ ğ’´ x
_â‡’â‚â‚€â‚€_ ğ’³ ğ’´ {y}{a}{x} g Î± = S.cmp (apâ‚€ Î± x) S.âŸ¨ apâ‚€ C.â‰ª g âˆ˜-â‰«â‚ x âŠ— S.idn âŸ©

_â‡’â‚â‚€_
  : âˆ€ {Î“} (ğ’³ ğ’´ : Presheaf Î“) {y a}
  â†’ Î“ âŠ§ a â‡¾ y
  â†’ â‰ªFunctorâ‰« _ _ âŠ§ â‰ª Î“ [-, y ]â‰« âŠ— ğ’³ â‡¾ ğ’´
  â†’ â‰ªFunctorâ‰« _ _ âŠ§ â‰ª Î“ [-, a ]â‰« âŠ— ğ’³ â‡¾ ğ’´
_â‡’â‚â‚€_ {Î“} ğ’³ ğ’´ g Î± .apâ‚€ x = (ğ’³ â‡’â‚â‚€â‚€ ğ’´) g Î±
_â‡’â‚â‚€_ {Î“} ğ’³ ğ’´ g Î± .apâ‚ {a}{x} k =
  cmpâ‚€ (apâ‚€ ğ’´ x)
    (apâ‚ Î± k)
    (apâ‚ (apâ‚€ Î± x) (invâ‚ Î“ (coh-Î± Î“) , idnâ‚€ (apâ‚€ ğ’³ x)))

_â‡’â‚â‚_
  : âˆ€ {Î“} (ğ’³ ğ’´ : Presheaf Î“) {y a} {g : âŸª Î“ âŸ« .âˆ‚ a y .â—}
  â†’ (Î± Î² : â‰ªFunctorâ‰« _ _ âŠ§ â‰ª Î“ [-, y ]â‰« âŠ— ğ’³ â‡¾ ğ’´)
  â†’ hom ((ğ’³ â‡’â‚€ ğ’´) y) Î± Î²
  â†’ hom ((ğ’³ â‡’â‚€ ğ’´) a) ((ğ’³ â‡’â‚â‚€ ğ’´) g Î±) ((ğ’³ â‡’â‚â‚€ ğ’´) g Î²)
_â‡’â‚â‚_ ğ’³ ğ’´ Î± Î² p = p

_â‡’â‚_
  : âˆ€ {Î“} (ğ’³ ğ’´ : Presheaf Î“) {x y}
  â†’ Î“ âŠ§ y â‡¾ x
  â†’ â‰ªSetoidâ‰« âŠ§ (ğ’³ â‡’â‚€ ğ’´) x â‡¾ (ğ’³ â‡’â‚€ ğ’´) y
_â‡’â‚_ ğ’³ ğ’´ f .apâ‚€ = (ğ’³ â‡’â‚â‚€ ğ’´) f
_â‡’â‚_ ğ’³ ğ’´ f .apâ‚ {Î±}{Î²} = (ğ’³ â‡’â‚â‚ ğ’´) Î± Î²

_â‡’â‚‚_
  : âˆ€ {Î“} (ğ’³ ğ’´ : Presheaf Î“)
  â†’ âˆ€ {y a}{gâ‚€ gâ‚ : Op Î“ âŠ§ y â‡¾ a}
  â†’ Op Î“ âŠ§ gâ‚€ â‡” gâ‚
  â†’ â‰ªSetoidâ‰« âŠ§ (ğ’³ â‡’â‚ ğ’´) gâ‚€ â‡” (ğ’³ â‡’â‚ ğ’´) gâ‚
_â‡’â‚‚_ {Î“} ğ’³ ğ’´ {y}{a}{gâ‚€}{gâ‚} p {Î±}{x}{f , s} = apâ‚ (apâ‚€ Î± x) (coh-Ï‰-Î» Î“ p , idnâ‚€ (apâ‚€ ğ’³ x))

_â‡’_ : âˆ€ {Î“} (ğ’³ ğ’´ : Presheaf Î“) â†’ Presheaf Î“
_â‡’_ {Î“} ğ’³ ğ’´ .apâ‚€ = ğ’³ â‡’â‚€ ğ’´
_â‡’_ {Î“} ğ’³ ğ’´ .apâ‚ = ğ’³ â‡’â‚ ğ’´
_â‡’_ {Î“} ğ’³ ğ’´ .apâ‚‚ = ğ’³ â‡’â‚‚ ğ’´
_â‡’_ {Î“} ğ’³ ğ’´ .coh-idn {y}{Î±}{x}{f , s} = apâ‚ (apâ‚€ Î± x) (coh-Î» Î“ , idnâ‚€ (apâ‚€ ğ’³ x))
_â‡’_ {Î“} ğ’³ ğ’´ .coh-cmp {y}{b}{a} g h {Î±}{x}{f , s} = apâ‚ (apâ‚€ Î± x) (coh-Î± Î“ , idnâ‚€ (apâ‚€ ğ’³ x))
