module CCC where

open import Basis
open import Cubical

module CCC where

ğŸ˜ : âˆ€ {Î“} â†’ Presheaf Î“
ğŸ˜ {Î“} .apâ‚€ x = S.ğŸ˜
ğŸ˜ {Î“} .apâ‚ f = S.idn
ğŸ˜ {Î“} .apâ‚‚ Î± {()}
ğŸ˜ {Î“} .coh-idn {x} {()}
ğŸ˜ {Î“} .coh-cmp g f {()}

Â¡ : âˆ€ {Î“} {ğ’³ : Presheaf Î“} â†’ Transform ğŸ˜ ğ’³
Â¡ {ğ’³ = ğ’³} .apâ‚€ x = S.Â¡
Â¡ {ğ’³ = ğ’³} .apâ‚ f {()}

ğŸ™ : âˆ€ {Î“} â†’ Presheaf Î“
ğŸ™ {Î“} .apâ‚€ x = S.ğŸ™
ğŸ™ {Î“} .apâ‚ f = S.idn
ğŸ™ {Î“} .apâ‚‚ Î± = *
ğŸ™ {Î“} .coh-idn = *
ğŸ™ {Î“} .coh-cmp g f = *

! : âˆ€ {Î“} {ğ’³ : Presheaf Î“} â†’ Transform ğ’³ ğŸ™
! {ğ’³ = ğ’³} .apâ‚€ x = S.!
! {ğ’³ = ğ’³} .apâ‚ f = *

_âŠ—_ : âˆ€ {Î“} (ğ’³ ğ’´ : Presheaf Î“) â†’ Presheaf Î“
(ğ’³ âŠ— ğ’´) .apâ‚€ x = apâ‚€ ğ’³ x S.âŠ— apâ‚€ ğ’´ x
(ğ’³ âŠ— ğ’´) .apâ‚ {x}{y} f .apâ‚€ (ğ’³Â·x , ğ’´Â·x) = apâ‚€ (apâ‚ ğ’³ f) ğ’³Â·x , apâ‚€ (apâ‚ ğ’´ f) ğ’´Â·x
(ğ’³ âŠ— ğ’´) .apâ‚ {x}{y} f .apâ‚ {ğ’³Â·x , ğ’´Â·x}{ğ’³Â·y , ğ’´Â·y} (p , q) = apâ‚ (apâ‚ ğ’³ f) p , apâ‚ (apâ‚ ğ’´ f) q
(ğ’³ âŠ— ğ’´) .apâ‚‚ {x}{y}{f}{g} Î± {ğ’³Â·x , ğ’´Â·x} = apâ‚‚ ğ’³ Î± , apâ‚‚ ğ’´ Î±
(ğ’³ âŠ— ğ’´) .coh-idn {x}{ğ’³Â·x , ğ’´Â·x} = coh-idn ğ’³ , coh-idn ğ’´
(ğ’³ âŠ— ğ’´) .coh-cmp g f = coh-cmp ğ’³ g f , coh-cmp ğ’´ g f

fst : âˆ€ {Î“} {ğ’³ ğ’´ : Presheaf Î“} â†’ Transform (ğ’³ âŠ— ğ’´) ğ’³
fst {Î“}{ğ’³}{ğ’´} .apâ‚€ x = S.fst
fst {Î“}{ğ’³}{ğ’´} .apâ‚ f = idnâ‚€ (apâ‚€ ğ’³ _)

snd : âˆ€ {Î“} {ğ’³ ğ’´ : Presheaf Î“} â†’ Transform (ğ’³ âŠ— ğ’´) ğ’´
snd {Î“}{ğ’³}{ğ’´} .apâ‚€ x = S.snd
snd {Î“}{ğ’³}{ğ’´} .apâ‚ f = idnâ‚€ (apâ‚€ ğ’´ _)

âŸ¨_,_âŸ©
  : âˆ€ {Î“} {ğ’³ ğ’´ H : Presheaf Î“}
  â†’ (Î± : Transform H ğ’³)
  â†’ (Î² : Transform H ğ’´)
  â†’ Transform H (ğ’³ âŠ— ğ’´)
âŸ¨ Î± , Î² âŸ© .apâ‚€ x = S.âŸ¨ apâ‚€ Î± x , apâ‚€ Î² x âŸ©
âŸ¨ Î± , Î² âŸ© .apâ‚ f = apâ‚ Î± f , apâ‚ Î² f

_â‡’â‚€_
  : âˆ€ {Î“} (ğ’³ ğ’´ : Presheaf Î“)
  â†’ âŸª Î“ âŸ« .â—
  â†’ Setoid
_â‡’â‚€_ {Î“} ğ’³ ğ’´ x = â‰ªhomâ‰« (C.â‰ªFunctorâ‰« (C.Op Î“) C.â‰ªSetoidâ‰«) (apâ‚€ (Yoneda Î“) x âŠ— ğ’³) ğ’´

_â‡’â‚â‚€_
  : âˆ€ {Î“} (ğ’³ ğ’´ : Presheaf Î“) {y a}
  â†’ Î“ âŠ§ a â‡¾ y
  â†’ C.â‰ªFunctorâ‰« _ _ âŠ§ apâ‚€ (Yoneda Î“) y âŠ— ğ’³ â‡¾ ğ’´
  â†’ C.â‰ªFunctorâ‰« _ _ âŠ§ apâ‚€ (Yoneda Î“) a âŠ— ğ’³ â‡¾ ğ’´
_â‡’â‚â‚€_ {Î“} ğ’³ ğ’´ {y}{a} g Î± .apâ‚€ x .apâ‚€ (f , s) = apâ‚€ (apâ‚€ Î± x) (cmpâ‚€ Î“ g f , s)
_â‡’â‚â‚€_ {Î“} ğ’³ ğ’´ {y}{a} g Î± .apâ‚€ x .apâ‚ {fâ‚€ , sâ‚€}{fâ‚ , sâ‚} (Î² , p) = apâ‚ (apâ‚€ Î± x) (coh-Ï‰-Ï Î“ Î² , p)
_â‡’â‚â‚€_ {Î“} ğ’³ ğ’´ {y}{b} g Î± .apâ‚ {a}{x} k {f , s} =
  cmpâ‚€ (apâ‚€ ğ’´ x)
    (apâ‚ Î± k)
    (apâ‚ (apâ‚€ Î± x) (invâ‚ Î“ (coh-Î± Î“) , idnâ‚€ (apâ‚€ ğ’³ x)))

_â‡’â‚â‚_
  : âˆ€ {Î“} (ğ’³ ğ’´ : Presheaf Î“) {y a} (g : âŸª Î“ âŸ« .âˆ‚ a y .â—) {Î± Î²}
  â†’ hom ((ğ’³ â‡’â‚€ ğ’´) y) Î± Î²
  â†’ hom ((ğ’³ â‡’â‚€ ğ’´) a) ((ğ’³ â‡’â‚â‚€ ğ’´) g Î±) ((ğ’³ â‡’â‚â‚€ ğ’´) g Î²)
_â‡’â‚â‚_ {Î“} ğ’³ ğ’´ {y}{a} g {Î±}{Î²} p {x} {f , s} = p

_â‡’â‚_
  : âˆ€ {Î“} (ğ’³ ğ’´ : Presheaf Î“) {x y}
  â†’ Î“ âŠ§ y â‡¾ x
  â†’ C.â‰ªSetoidâ‰« âŠ§ (ğ’³ â‡’â‚€ ğ’´) x â‡¾ (ğ’³ â‡’â‚€ ğ’´) y
_â‡’â‚_ ğ’³ ğ’´ f .apâ‚€ = (ğ’³ â‡’â‚â‚€ ğ’´) f
_â‡’â‚_ ğ’³ ğ’´ f .apâ‚ {Î±}{Î²} = (ğ’³ â‡’â‚â‚ ğ’´) f {Î±}{Î²}

_â‡’â‚‚_
  : âˆ€ {Î“} (ğ’³ ğ’´ : Presheaf Î“)
  â†’ âˆ€ {y a}{gâ‚€ gâ‚ : C.Op Î“ âŠ§ y â‡¾ a}
  â†’ C.Op Î“ âŠ§ gâ‚€ â‡” gâ‚
  â†’ C.â‰ªSetoidâ‰« âŠ§ (ğ’³ â‡’â‚ ğ’´) gâ‚€ â‡” (ğ’³ â‡’â‚ ğ’´) gâ‚
_â‡’â‚‚_ {Î“} ğ’³ ğ’´ {y}{a}{gâ‚€}{gâ‚} p {Î±}{x}{f , s} = apâ‚ (apâ‚€ Î± x) (coh-Ï‰-Î» Î“ p , idnâ‚€ (apâ‚€ ğ’³ x))

_â‡’_ : âˆ€ {Î“} (ğ’³ ğ’´ : Presheaf Î“) â†’ Presheaf Î“
_â‡’_ {Î“} ğ’³ ğ’´ .apâ‚€ = ğ’³ â‡’â‚€ ğ’´
_â‡’_ {Î“} ğ’³ ğ’´ .apâ‚ = ğ’³ â‡’â‚ ğ’´
_â‡’_ {Î“} ğ’³ ğ’´ .apâ‚‚ = ğ’³ â‡’â‚‚ ğ’´
_â‡’_ {Î“} ğ’³ ğ’´ .coh-idn {y}{Î±}{x}{f , s} = apâ‚ (apâ‚€ Î± x) (coh-Î» Î“ , idnâ‚€ (apâ‚€ ğ’³ x))
_â‡’_ {Î“} ğ’³ ğ’´ .coh-cmp {y}{b}{a} g h {Î±}{x}{f , s} = apâ‚ (apâ‚€ Î± x) (coh-Î± Î“ , idnâ‚€ (apâ‚€ ğ’³ x))
